import{j as a}from"./index-DgjA3nOz.js";import{b as i}from"./vendor-Bu9rO6sl.js";import{u as A}from"./bookmark-DH4hLNb0.js";import E from"./index-Kao7MEJ2.js";import C from"./index-Da0VYwiU.js";import T from"./index-DcNVrDEX.js";import v from"./index-C_HoH5kK.js";import{b as f}from"./bookmark-1YsDU-AS.js";import{DashboardHeader as U}from"./DashboardHeader-BdTUzQpb.js";import"./utils-Pd6Wu3Vt.js";import"./BookmarkForm-BBrk4Yz0.js";import"./AnalysisStatus-B8SIan8h.js";import"./index-C334YfuK.js";import"./BookmarkItem-uQGCwS8s.js";import"./zh-CN-tscHfJwX.js";function D({message:r,type:o="success",onClose:e,duration:t=3e3}){return i.useEffect(()=>{const c=setTimeout(()=>{e()},t);return()=>clearTimeout(c)},[t,e]),a.jsxs("div",{className:`notification notification-${o}`,children:[a.jsx("span",{className:"notification-icon",children:o==="success"?"✓":"✕"}),a.jsx("span",{className:"notification-message",children:r})]})}function L(){const[r,o]=i.useState(null);return{notification:r,notify:(c,m)=>{o({type:c,message:m})},clearNotification:()=>{o(null)}}}function M(r,o){const[e,t]=i.useState(!1);return{isProcessing:e,addBookmark:async s=>{t(!0);try{await f.create(s),o("success","成功添加书签"),await r()}catch(n){console.error("添加书签失败:",n),o("error","添加书签失败，请稍后重试")}finally{t(!1)}},updateBookmark:async s=>{t(!0);try{await f.update(s),o("success","成功更新书签"),await r()}catch(n){console.error("更新书签失败:",n),o("error","更新书签失败，请稍后重试")}finally{t(!1)}},deleteBookmark:async s=>{t(!0);try{await f.delete(s),o("success","成功删除书签"),await r()}catch(n){console.error("删除书签失败:",n),o("error","删除书签失败")}finally{t(!1)}},copyUrl:s=>{navigator.clipboard.writeText(s).then(()=>o("success","URL已复制到剪贴板")).catch(()=>o("error","复制失败，请手动复制"))}}}function X(){const[r,o]=i.useState(!0),{list:e,fetchBookmarks:t}=A(),[c,m]=i.useState("bookmarks"),[p,d]=i.useState(!1),[s,n]=i.useState(null),{notification:u,notify:k,clearNotification:h}=L(),{addBookmark:B,updateBookmark:y,deleteBookmark:w,copyUrl:x}=M(t,k);i.useEffect(()=>{(async()=>{o(!0);try{await t()}catch(S){console.error("加载书签失败:",S),k("error","加载书签失败")}finally{o(!1)}})()},[]);const b=async l=>{await B(l),d(!1)},g=async l=>{await y(l),n(null)},j=async l=>{window.confirm(`确定要删除书签 "${l.name}" 吗？`)&&await w(l)},N=async()=>{await t(),k("success","书签已恢复")};return a.jsxs(a.Fragment,{children:[a.jsx(U,{onAddClick:()=>d(!0),bookmarkCount:(e==null?void 0:e.length)||0,activeTab:c,onTabChange:m}),a.jsx("div",{className:"dashboard-content",children:c==="bookmarks"?a.jsx(T,{bookmarks:e,isLoading:r,onEdit:n,onDelete:j,onCopyUrl:x}):a.jsx(v,{onRestore:N,onNotify:k})}),p&&a.jsx(E,{onClose:()=>d(!1),onSubmit:b}),s&&a.jsx(C,{bookmark:s,onClose:()=>n(null),onSubmit:g}),u&&a.jsx(D,{type:u.type,message:u.message,onClose:h})]})}export{X as default};
