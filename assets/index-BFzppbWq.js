import{j as t}from"./index-DqCV7gAo.js";import{r as a}from"./vendor-DS5US8IS.js";import{u as y}from"./bookmark-BdcgMAUv.js";import{M as b}from"./index-lojDlI4L.js";import"./utils-BxBsLso0.js";function D({bookmark:n,onClose:d,onSubmit:f}){const{list:c}=y(),[s,i]=a.useState({name:n.name,category:n.category,icon:n.icon}),[g,x]=a.useState([]),[u,m]=a.useState(!1),[o,h]=a.useState(!1),[p,j]=a.useState(!1),l=a.useRef({name:n.name,category:n.category,icon:n.icon}).current;a.useEffect(()=>{const e=s.name!==l.name||s.category!==l.category||s.icon!==l.icon;j(e)},[s,l]),a.useEffect(()=>{if(c&&c.length>0){const e=[...new Set(c.map(r=>r.category).filter(Boolean))];x(e)}},[c]),a.useEffect(()=>{const e=r=>{u&&!r.target.closest(".category-select-container")&&m(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u]);const v=async e=>{if(e.preventDefault(),!(!p||o)){h(!0);try{await f({...n,...s}),d()}catch(r){console.error("保存书签失败:",r)}finally{h(!1)}}};return t.jsx(b,{isOpen:!0,onClose:d,title:"编辑书签",size:"md",position:"center",children:t.jsx("div",{className:"bookmark-modal-content",children:t.jsxs("form",{onSubmit:v,children:[t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"名称"}),t.jsx("input",{type:"text",value:s.name,onChange:e=>i({...s,name:e.target.value}),required:!0})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"图标"}),t.jsxs("div",{className:"icon-input-container",children:[t.jsx("input",{type:"text",value:s.icon,onChange:e=>i({...s,icon:e.target.value}),placeholder:"输入图标 URL"}),s.icon&&t.jsx("div",{className:"icon-preview",children:t.jsx("img",{src:s.icon,alt:"图标预览",onError:e=>e.target.src="/fallback-icon.svg"})})]})]}),t.jsxs("div",{className:"form-group",children:[t.jsx("label",{children:"分类"}),t.jsxs("div",{className:"category-select-container",children:[t.jsx("input",{type:"text",value:s.category,onChange:e=>i({...s,category:e.target.value}),onFocus:()=>m(!0),placeholder:"选择或输入新分类"}),u&&g.length>0&&t.jsx("div",{className:"category-dropdown",children:g.map(e=>t.jsx("div",{className:`category-option ${e===s.category?"selected":""}`,onClick:()=>{i({...s,category:e}),m(!1)},children:e},e))})]})]}),t.jsxs("div",{className:"modal-actions",children:[t.jsx("button",{type:"button",className:"cancel-button",onClick:d,disabled:o,children:"取消"}),t.jsx("button",{type:"submit",className:`submit-button ${o?"loading":""}`,disabled:!p||o,children:o?"保存中...":"保存修改"})]})]})})})}export{D as default};
