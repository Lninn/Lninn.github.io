import{j as e}from"./index-BtK_pdOW.js";import{b as c}from"./vendor-D6FSTBK7.js";import{u as C}from"./bookmark-Bns0kixm.js";import E from"./index-Cv_dSSah.js";import N from"./index-DE95sXHx.js";import U from"./index-C5AP4eud.js";import v from"./index-CPAzc_7C.js";import{u as D,N as L}from"./useNotification-Cvhw_tEf.js";import{b as u}from"./bookmark-B50xnGWW.js";import{DashboardHeader as M}from"./DashboardHeader-CPLnaBpE.js";import"./utils-B-ph8sPT.js";import"./BookmarkForm-DVBMb3PC.js";import"./AnalysisStatus-BhpbrMVP.js";import"./index-Ck48Jn3l.js";import"./BookmarkItem-BncoDATj.js";import"./zh-CN-BsVeUFFo.js";function R(i,o){const[n,a]=c.useState(!1);return{isProcessing:n,addBookmark:async r=>{a(!0);try{await u.create(r),o("success","成功添加书签"),await i()}catch(t){console.error("添加书签失败:",t),o("error","添加书签失败，请稍后重试")}finally{a(!1)}},updateBookmark:async r=>{a(!0);try{await u.update(r),o("success","成功更新书签"),await i()}catch(t){console.error("更新书签失败:",t),o("error","更新书签失败，请稍后重试")}finally{a(!1)}},deleteBookmark:async r=>{a(!0);try{await u.delete(r),o("success","成功删除书签"),await i()}catch(t){console.error("删除书签失败:",t),o("error","删除书签失败")}finally{a(!1)}},copyUrl:r=>{navigator.clipboard.writeText(r).then(()=>o("success","URL已复制到剪贴板")).catch(()=>o("error","复制失败，请手动复制"))}}}function Y(){const[i,o]=c.useState(!0),{list:n,fetchBookmarks:a}=C(),[d,p]=c.useState("bookmarks"),[f,m]=c.useState(!1),[r,t]=c.useState(null),{notification:k,notify:l,clearNotification:B}=D(),{addBookmark:h,updateBookmark:y,deleteBookmark:w,copyUrl:b}=R(a,l);c.useEffect(()=>{(async()=>{o(!0);try{await a()}catch(A){console.error("加载书签失败:",A),l("error","加载书签失败")}finally{o(!1)}})()},[]);const x=async s=>{await h(s),m(!1)},g=async s=>{await y(s),t(null)},j=async s=>{window.confirm(`确定要删除书签 "${s.name}" 吗？`)&&await w(s)},S=async()=>{await a(),l("success","书签已恢复")};return e.jsxs(e.Fragment,{children:[e.jsx(M,{onAddClick:()=>m(!0),bookmarkCount:(n==null?void 0:n.length)||0,activeTab:d,onTabChange:p}),e.jsx("div",{className:"dashboard-content",children:d==="bookmarks"?e.jsx(U,{bookmarks:n,isLoading:i,onEdit:t,onDelete:j,onCopyUrl:b}):e.jsx(v,{onRestore:S,onNotify:l})}),f&&e.jsx(E,{onClose:()=>m(!1),onSubmit:x}),r&&e.jsx(N,{bookmark:r,onClose:()=>t(null),onSubmit:g}),k&&e.jsx(L,{type:k.type,message:k.message,onClose:B})]})}export{Y as default};
