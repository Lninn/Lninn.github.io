import{j as m}from"./index-D9YksUlk.js";import{b as n}from"./vendor-D6FSTBK7.js";import y from"./TimerHeader-BTH6b0zC.js";import x from"./ModeIndicator-G-_HJxS4.js";import j from"./TimerDisplay-DY6VMAIP.js";import v from"./TimerControls-BF9QU_-L.js";import w from"./SettingsPanel-CSUzFT-S.js";import I from"./TimerTips-DXsSy_73.js";import M from"./RecordsPanel-C-wEzZoW.js";import"./utils-B-ph8sPT.js";import"./SettingsIcon-B1Mvj23o.js";import"./RecordButton-DWdL8PtQ.js";function B(r,i){const[l,f]=n.useState(!1),[s,a]=n.useState("focus"),[c,t]=n.useState(r.focusTime*60),[e,S]=n.useState({...r,soundOption:r.soundOption||"bell"}),[g,R]=n.useState(0),[u,k]=n.useState(null),[p,b]=n.useState(0),T=n.useRef(null);return n.useEffect(()=>{const o={bell:"/sounds/bell.mp3",complete:"/sounds/complete.mp3",meditation:"/sounds/meditation-bell.mp3"};return T.current=new Audio(o[e.soundOption]),()=>{T.current&&(T.current.pause(),T.current=null)}},[e.soundOption]),n.useEffect(()=>{l&&s==="focus"&&!u&&k(new Date)},[l,s,u]),n.useEffect(()=>{let o=null;if(l&&c>0)o=setInterval(()=>{t(c-1),s==="focus"&&b(d=>d+1/60)},1e3);else if(l&&c===0)if(T.current&&T.current.play(),s==="focus"){const d=g+1;R(d),d%e.longBreakInterval===0?(a("longBreak"),t(e.longBreakTime*60)):(a("break"),t(e.breakTime*60))}else{if(i&&u){const d={focusTime:Math.round(p),cycles:g,mode:s,duration:Math.round((new Date-u)/1e3/60)};i(d),k(null),b(0)}a("focus"),t(e.focusTime*60)}return()=>clearInterval(o)},[l,c,s,e,g,i,u,p]),{isRunning:l,mode:s,timeLeft:c,settings:e,cycles:g,totalFocusTime:p,formatTime:o=>{const d=Math.floor(o/60),h=o%60;return`${d.toString().padStart(2,"0")}:${h.toString().padStart(2,"0")}`},calculateProgress:()=>{const o=s==="focus"?e.focusTime*60:s==="break"?e.breakTime*60:e.longBreakTime*60;return(o-c)/o*100},toggleTimer:()=>{f(!l)},resetTimer:()=>{if(f(!1),t(s==="focus"?e.focusTime*60:s==="break"?e.breakTime*60:e.longBreakTime*60),u&&p>0&&i){const o={focusTime:Math.round(p),cycles:g,mode:s,duration:Math.round((new Date-u)/1e3/60)};i(o),k(null),b(0)}},updateSettings:o=>{S(o),t(s==="focus"?o.focusTime*60:s==="break"?o.breakTime*60:o.longBreakTime*60)}}}function O(){const[r,i]=n.useState(()=>{const a=localStorage.getItem("reading-timer-records");return a?JSON.parse(a):[]});return n.useEffect(()=>{localStorage.setItem("reading-timer-records",JSON.stringify(r))},[r]),{records:r,addRecord:a=>{const c={...a,id:Date.now(),timestamp:new Date().toISOString()};i(t=>[c,...t])},clearRecords:()=>{i([])},getStats:()=>{if(r.length===0)return{totalFocusTime:0,totalSessions:0,totalCycles:0,averageFocusTime:0};const a=r.reduce((c,t)=>c+(t.focusTime||0),0);return{totalFocusTime:a,totalSessions:r.length,totalCycles:r.reduce((c,t)=>c+(t.cycles||0),0),averageFocusTime:Math.round(a/r.length)}}}}function V(){const[r,i]=n.useState(!1),[l,f]=n.useState(!1),{records:s,addRecord:a,clearRecords:c,getStats:t}=O(),e=B({focusTime:25,breakTime:5,longBreakTime:15,longBreakInterval:4,soundOption:"bell"},a),S=()=>{i(!r),e.isRunning&&e.toggleTimer(),f(!1)},g=()=>{f(!l),i(!1)},R=u=>{e.updateSettings(u),i(!1)};return m.jsx("div",{className:"reading-timer-container",children:m.jsxs("div",{className:"timer-card",children:[m.jsx(y,{onSettingsClick:S,onRecordsClick:g}),m.jsx(x,{mode:e.mode,cycles:e.cycles}),m.jsx(j,{timeText:e.formatTime(e.timeLeft),progress:e.calculateProgress()}),m.jsx(v,{isRunning:e.isRunning,onToggle:e.toggleTimer,onReset:e.resetTimer}),r&&m.jsx(w,{settings:e.settings,onCancel:()=>i(!1),onApply:R}),l&&m.jsx(M,{records:s,stats:t(),onClear:c,onClose:()=>f(!1)}),m.jsx(I,{})]})})}export{V as default};
