import{j as L}from"./index-CGDsmW8e.js";import{c as E,b as I}from"./vendor-D6FSTBK7.js";import"./utils-B-ph8sPT.js";var b={exports:{}},_=b.exports,y;function P(){return y||(y=1,function(g,M){(function(p,w){g.exports=w()})(_,function(){function p(n){var d=[];return n.AMapUI&&d.push(w(n.AMapUI)),n.Loca&&d.push(m(n.Loca)),Promise.all(d)}function w(n){return new Promise(function(d,t){var a=[];if(n.plugins)for(var u=0;u<n.plugins.length;u+=1)e.AMapUI.plugins.indexOf(n.plugins[u])==-1&&a.push(n.plugins[u]);if(i.AMapUI===o.failed)t("前次请求 AMapUI 失败");else if(i.AMapUI===o.notload){i.AMapUI=o.loading,e.AMapUI.version=n.version||e.AMapUI.version,u=e.AMapUI.version;var c=document.body||document.head,l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/ui/"+u+"/main.js",l.onerror=function(s){i.AMapUI=o.failed,t("请求 AMapUI 失败")},l.onload=function(){if(i.AMapUI=o.loaded,a.length)window.AMapUI.loadUI(a,function(){for(var s=0,f=a.length;s<f;s++){var v=a[s].split("/").slice(-1)[0];window.AMapUI[v]=arguments[s]}for(d();r.AMapUI.length;)r.AMapUI.splice(0,1)[0]()});else for(d();r.AMapUI.length;)r.AMapUI.splice(0,1)[0]()},c.appendChild(l)}else i.AMapUI===o.loaded?n.version&&n.version!==e.AMapUI.version?t("不允许多个版本 AMapUI 混用"):a.length?window.AMapUI.loadUI(a,function(){for(var s=0,f=a.length;s<f;s++){var v=a[s].split("/").slice(-1)[0];window.AMapUI[v]=arguments[s]}d()}):d():n.version&&n.version!==e.AMapUI.version?t("不允许多个版本 AMapUI 混用"):r.AMapUI.push(function(s){s?t(s):a.length?window.AMapUI.loadUI(a,function(){for(var f=0,v=a.length;f<v;f++){var x=a[f].split("/").slice(-1)[0];window.AMapUI[x]=arguments[f]}d()}):d()})})}function m(n){return new Promise(function(d,t){if(i.Loca===o.failed)t("前次请求 Loca 失败");else if(i.Loca===o.notload){i.Loca=o.loading,e.Loca.version=n.version||e.Loca.version;var a=e.Loca.version,u=e.AMap.version.startsWith("2"),c=a.startsWith("2");if(u&&!c||!u&&c)t("JSAPI 与 Loca 版本不对应！！");else{u=e.key,c=document.body||document.head;var l=document.createElement("script");l.type="text/javascript",l.src="https://webapi.amap.com/loca?v="+a+"&key="+u,l.onerror=function(s){i.Loca=o.failed,t("请求 AMapUI 失败")},l.onload=function(){for(i.Loca=o.loaded,d();r.Loca.length;)r.Loca.splice(0,1)[0]()},c.appendChild(l)}}else i.Loca===o.loaded?n.version&&n.version!==e.Loca.version?t("不允许多个版本 Loca 混用"):d():n.version&&n.version!==e.Loca.version?t("不允许多个版本 Loca 混用"):r.Loca.push(function(s){s?t(s):t()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var o;(function(n){n.notload="notload",n.loading="loading",n.loaded="loaded",n.failed="failed"})(o||(o={}));var e={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},r={AMapUI:[],Loca:[]},A=[],h=function(n){typeof n=="function"&&(i.AMap===o.loaded?n(window.AMap):A.push(n))};return{load:function(n){return new Promise(function(d,t){if(i.AMap==o.failed)t("");else if(i.AMap==o.notload){var a=n.key,u=n.version,c=n.plugins;a?(window.AMap&&location.host!=="lbs.amap.com"&&t("禁止多种API加载方式混用"),e.key=a,e.AMap.version=u||e.AMap.version,e.AMap.plugins=c||e.AMap.plugins,i.AMap=o.loading,u=document.body||document.head,window.___onAPILoaded=function(s){if(delete window.___onAPILoaded,s)i.AMap=o.failed,t(s);else for(i.AMap=o.loaded,p(n).then(function(){d(window.AMap)}).catch(t);A.length;)A.splice(0,1)[0]()},c=document.createElement("script"),c.type="text/javascript",c.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+e.AMap.version+"&key="+a+"&plugin="+e.AMap.plugins.join(","),c.onerror=function(s){i.AMap=o.failed,t(s)},u.appendChild(c)):t("请填写key")}else if(i.AMap==o.loaded)if(n.key&&n.key!==e.key)t("多个不一致的 key");else if(n.version&&n.version!==e.AMap.version)t("不允许多个版本 JSAPI 混用");else{if(a=[],n.plugins)for(u=0;u<n.plugins.length;u+=1)e.AMap.plugins.indexOf(n.plugins[u])==-1&&a.push(n.plugins[u]);a.length?window.AMap.plugin(a,function(){p(n).then(function(){d(window.AMap)}).catch(t)}):p(n).then(function(){d(window.AMap)}).catch(t)}else if(n.key&&n.key!==e.key)t("多个不一致的 key");else if(n.version&&n.version!==e.AMap.version)t("不允许多个版本 JSAPI 混用");else{var l=[];if(n.plugins)for(u=0;u<n.plugins.length;u+=1)e.AMap.plugins.indexOf(n.plugins[u])==-1&&l.push(n.plugins[u]);h(function(){l.length?window.AMap.plugin(l,function(){p(n).then(function(){d(window.AMap)}).catch(t)}):p(n).then(function(){d(window.AMap)}).catch(t)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,e={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},i={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},r={AMap:[],AMapUI:[],Loca:[]}}}})}(b)),b.exports}var k=P();const C=E(k),U={strokeColor:"blue",strokeWeight:3},O={strokeColor:"red",strokeWeight:5};function N({userPathList:g,activeUserPath:M}){const[p,w]=I.useState(null),[m,o]=I.useState([]);return I.useEffect(()=>(window._AMapSecurityConfig={securityJsCode:"cbda977efbb9bf5d0b4809ae711ccba7"},C.load({key:"16e9f3a53e15d22721e46259c3a8a8d2",version:"2.0"}).then(e=>{const i=new e.Map("container",{viewMode:"2D",zoom:5,center:[116.397428,39.90923],features:["bg","point"]});w(i)}).catch(e=>{console.log(e)}),()=>{p==null||p.destroy()}),[]),I.useEffect(()=>{if(!p||g.length===0)return;const e=[];return g.map(r=>({locations:r.gps_path.split("|").map(h=>new window.AMap.LngLat(...h.split(","))),id:r.id})).forEach(r=>{const A=new window.AMap.Polyline({path:r.locations,...U,extData:{userPathId:r.id}});e.push(A),p.add(A)}),p.setFitView(e),o(e),()=>{p&&(e.forEach(r=>{p.remove(r)}),o([]))}},[p,g]),I.useEffect(()=>{if(!M)return;const e=m.find(i=>i.getExtData().userPathId===(M==null?void 0:M.id));if(e){e.setOptions(O);const i=e.getBounds(),[,r]=p.getFitZoomAndCenterByBounds(i);p.setCenter(r)}return()=>{e.setOptions(U)}},[p,M,m]),L.jsx(L.Fragment,{children:L.jsx("div",{id:"container",className:"container",style:{height:"800px"}})})}export{N as default};
