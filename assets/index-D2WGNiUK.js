import{j as t,E as S}from"./index-CCUv_K3B.js";import{b as r}from"./vendor-Bu9rO6sl.js";import{b as y}from"./bookmark-ipBpbE8f.js";import b from"./UrlList-DZIihS_h.js";import L from"./BookmarkSkeleton-DgXiXSpL.js";import B from"./BookmarkHeader-CSXEVP8p.js";import"./utils-Pd6Wu3Vt.js";function F(){const[i,l]=r.useState(!0),[c,k]=r.useState(null),[p,x]=r.useState({list:[],viewsMap:new Map}),[a,m]=r.useState(""),[o,d]=r.useState("全部");r.useEffect(()=>{async function e(){try{const s=await y.fetchBookmarksWithViews();x(s)}catch(s){k(s.message)}finally{l(!1)}}e()},[]);const{list:n,viewsMap:j}=p,g=r.useMemo(()=>["全部",...new Set(n.map(([e])=>e))],[n]),u=r.useMemo(()=>!a&&o==="全部"?n:n.map(([e,s])=>{if(o!=="全部"&&e!==o)return[e,[]];const C=s.filter(h=>{const f=a.toLowerCase();return h.name.toLowerCase().includes(f)||h.url.toLowerCase().includes(f)});return[e,C]}).filter(([,e])=>e.length>0),[n,a,o]),w=e=>{d(o===e?"全部":e)};return c?t.jsxs("div",{className:"error-state",children:[t.jsxs("p",{children:["加载失败: ",c]}),t.jsx("button",{onClick:()=>window.location.reload(),children:"重试"})]}):t.jsxs(t.Fragment,{children:[t.jsx(B,{title:"我的书签",searchTerm:a,onSearchChange:m,onClearSearch:()=>m(""),categories:g,selectedCategory:o,onCategorySelect:w}),i?t.jsx(L,{}):t.jsx("section",{className:"bookmark-grid",children:u.length>0?u.map(([e,s])=>t.jsx(S,{showDetails:!1,children:t.jsx(v,{name:e,data:s,searchTerm:a,viewCount:j.get(e)||0})},e)):t.jsxs("div",{className:"no-results",children:[t.jsx("p",{children:"没有找到匹配的书签"}),t.jsx("button",{className:"reset-search",onClick:()=>{m(""),d("全部")},children:"重置搜索"})]})})]})}function v({name:i,data:l,searchTerm:c}){return t.jsxs("div",{className:"bookmark-category",children:[t.jsx("h2",{className:"category-title",children:i}),t.jsx(b,{list:l,searchTerm:c,category:i})]})}export{F as default};
