import{j as a}from"./index-CvC0IVlO.js";import{v as o,d as l,b as x,a as g,t as i,r as m,g as t,s as e,f as s,c as r}from"./react.esm-BQiRKoFw.js";import T from"./index-CJCuexuH.js";import"./vendor-D6FSTBK7.js";import"./utils-B-ph8sPT.js";import"./TimerHeader-BuQuFDqT.js";import"./SettingsIcon-CDfNfTGK.js";import"./RecordButton-D8nFj845.js";import"./ModeIndicator-De52GzXo.js";import"./TimerDisplay-BN5Q0iiv.js";import"./TimerControls-BtyyZB7K.js";import"./SettingsPanel-BkDZr9di.js";import"./TimerTips-C6zO1Dk6.js";import"./RecordsPanel-DSoVCCBz.js";import"./GoalProgress-Bpjm0ahy.js";import"./index-Cw3Sa-D2.js";o.mock("../../../components/Modal",()=>({default:({isOpen:n,onClose:c,children:B})=>n?a.jsx("div",{"data-testid":"modal",children:B}):null}));l("ReadingTimer 组件",()=>{x(()=>{o.resetAllMocks(),o.clearAllTimers(),localStorage.clear(),o.useFakeTimers(),window.Notification=o.fn().mockImplementation(()=>({close:o.fn()})),window.Notification.permission="granted",window.Notification.requestPermission=o.fn().mockResolvedValue("granted")}),g(()=>{o.restoreAllMocks(),o.useRealTimers()}),i("应该正确渲染初始状态",()=>{m(a.jsx(T,{})),t(e.getByText("专注阅读计时器")).toBeInTheDocument(),t(e.getByText("专注阅读")).toBeInTheDocument(),t(e.getByText("第 1 个周期")).toBeInTheDocument(),t(e.getByText("25:00")).toBeInTheDocument(),t(e.getByLabelText("开始")).toBeInTheDocument(),t(e.getByLabelText("重置")).toBeInTheDocument()}),i("点击开始按钮应该启动计时器",async()=>{m(a.jsx(T,{}));const n=e.getByLabelText("开始");s.click(n);for(let c=0;c<5;c++)r(()=>{o.advanceTimersByTime(1e3)});t(e.getByText("24:55")).toBeInTheDocument(),t(e.getByLabelText("暂停")).toBeInTheDocument()}),i("点击暂停按钮应该暂停计时器",()=>{m(a.jsx(T,{}));const n=e.getByLabelText("开始");s.click(n);for(let B=0;B<5;B++)r(()=>{o.advanceTimersByTime(1e3)});const c=e.getByLabelText("暂停");s.click(c),r(()=>{o.advanceTimersByTime(5*1e3)}),t(e.getByText("24:55")).toBeInTheDocument(),t(e.getByLabelText("开始")).toBeInTheDocument()}),i("点击重置按钮应该重置计时器",()=>{m(a.jsx(T,{}));const n=e.getByLabelText("开始");s.click(n),r(()=>{o.advanceTimersByTime(5*1e3)});const c=e.getByLabelText("重置");s.click(c),t(e.getByText("25:00")).toBeInTheDocument(),t(e.getByLabelText("开始")).toBeInTheDocument()}),i("完成一个专注周期后应该切换到休息模式",()=>{m(a.jsx(T,{}));const n=e.getByLabelText("开始");s.click(n);for(let c=0;c<25*60;c++)r(()=>{o.advanceTimersByTime(1e3)});t(e.getByText("短休息")).toBeInTheDocument(),t(e.getByText("第 2 个周期")).toBeInTheDocument(),t(e.getByText("05:00")).toBeInTheDocument()}),i("点击设置按钮应该打开设置面板",()=>{m(a.jsx(T,{}));const n=e.getByLabelText("设置");s.click(n),t(e.getByTestId("modal")).toBeInTheDocument(),t(e.getByText("计时器设置")).toBeInTheDocument()}),i("点击记录按钮应该打开记录面板",()=>{m(a.jsx(T,{}));const n=e.getByLabelText("查看记录");s.click(n),t(e.getByTestId("modal")).toBeInTheDocument(),t(e.getByText("阅读记录")).toBeInTheDocument()})});
