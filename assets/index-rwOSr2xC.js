import{j as m}from"./index-BsP3Y0uy.js";import{b as r}from"./vendor-D6FSTBK7.js";import b from"./TimerHeader-BxCcdx5S.js";import x from"./ModeIndicator-CIfjPbe2.js";import j from"./TimerDisplay-DIiPKZJB.js";import v from"./TimerControls-Woo5QWNA.js";import w from"./SettingsPanel-UJJJBhtM.js";import I from"./TimerTips-LJt_rIlC.js";import M from"./RecordsPanel-Cjk0hnKX.js";import"./utils-B-ph8sPT.js";import"./SettingsIcon-d3p001-l.js";import"./RecordButton-Bbp3jUfP.js";function B(n,c){const[l,f]=r.useState(!1),[s,a]=r.useState("focus"),[i,t]=r.useState(n.focusTime*60),[e,S]=r.useState(n),[g,R]=r.useState(0),[u,k]=r.useState(null),[p,h]=r.useState(0),T=r.useRef(null);return r.useEffect(()=>{const o={bell:"/sounds/bell.mp3",complete:"/sounds/complete.mp3",meditation:"/sounds/meditation-bell.mp3"};return T.current=new Audio(o[e.soundOption]),()=>{T.current&&(T.current.pause(),T.current=null)}},[e.soundOption]),r.useEffect(()=>{l&&s==="focus"&&!u&&k(new Date)},[l,s,u]),r.useEffect(()=>{let o=null;if(l&&i>0)o=setInterval(()=>{t(i-1),s==="focus"&&h(d=>d+1/60)},1e3);else if(l&&i===0)if(T.current&&T.current.play(),s==="focus"){const d=g+1;R(d),d%e.longBreakInterval===0?(a("longBreak"),t(e.longBreakTime*60)):(a("break"),t(e.breakTime*60))}else{if(c&&u){const d={focusTime:Math.round(p),cycles:g,mode:s,duration:Math.round((new Date-u)/1e3/60)};c(d),k(null),h(0)}a("focus"),t(e.focusTime*60)}return()=>clearInterval(o)},[l,i,s,e,g,c,u,p]),{isRunning:l,mode:s,timeLeft:i,settings:e,cycles:g,totalFocusTime:p,formatTime:o=>{const d=Math.floor(o/60),y=o%60;return`${d.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`},calculateProgress:()=>{const o=s==="focus"?e.focusTime*60:s==="break"?e.breakTime*60:e.longBreakTime*60;return(o-i)/o*100},toggleTimer:()=>{f(!l)},resetTimer:()=>{if(f(!1),t(s==="focus"?e.focusTime*60:s==="break"?e.breakTime*60:e.longBreakTime*60),u&&p>0&&c){const o={focusTime:Math.round(p),cycles:g,mode:s,duration:Math.round((new Date-u)/1e3/60)};c(o),k(null),h(0)}},updateSettings:o=>{S(o),t(s==="focus"?o.focusTime*60:s==="break"?o.breakTime*60:o.longBreakTime*60)}}}function C(){const[n,c]=r.useState(()=>{const a=localStorage.getItem("reading-timer-records");return a?JSON.parse(a):[]});return r.useEffect(()=>{localStorage.setItem("reading-timer-records",JSON.stringify(n))},[n]),{records:n,addRecord:a=>{const i={...a,id:Date.now(),timestamp:new Date().toISOString()};c(t=>[i,...t])},clearRecords:()=>{c([])},getStats:()=>{if(n.length===0)return{totalFocusTime:0,totalSessions:0,totalCycles:0,averageFocusTime:0};const a=n.reduce((i,t)=>i+(t.focusTime||0),0);return{totalFocusTime:a,totalSessions:n.length,totalCycles:n.reduce((i,t)=>i+(t.cycles||0),0),averageFocusTime:Math.round(a/n.length)}}}}function V(){const[n,c]=r.useState(!1),[l,f]=r.useState(!1),{records:s,addRecord:a,clearRecords:i,getStats:t}=C(),e=B({focusTime:25,breakTime:5,longBreakTime:15,longBreakInterval:4,soundOption:"bell"},a),S=()=>{c(!n),e.isRunning&&e.toggleTimer(),f(!1)},g=()=>{f(!l),c(!1)},R=u=>{e.updateSettings(u),c(!1)};return m.jsx("div",{className:"reading-timer-container",children:m.jsxs("div",{className:"timer-card",children:[m.jsx(b,{onSettingsClick:S,onRecordsClick:g}),m.jsx(x,{mode:e.mode,cycles:e.cycles}),m.jsx(j,{timeText:e.formatTime(e.timeLeft),progress:e.calculateProgress()}),m.jsx(v,{isRunning:e.isRunning,onToggle:e.toggleTimer,onReset:e.resetTimer}),n&&m.jsx(w,{settings:e.settings,onCancel:()=>c(!1),onApply:R}),l&&m.jsx(M,{records:s,stats:t(),onClear:i,onClose:()=>f(!1)}),m.jsx(I,{})]})})}export{V as default};
